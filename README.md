# ä»Šå¤©åƒä»€ä¹ˆ - What To Eat

ä¸€ä¸ªå…·æœ‰"ä»ªå¼æ„Ÿ"çš„åˆé¤å†³ç­– Appï¼Œå¸®åŠ©é€‰æ‹©å›°éš¾ç—‡æ‚£è€…åšå‡ºä»Šå¤©åƒä»€ä¹ˆçš„å†³å®šã€‚

## åŠŸèƒ½ç‰¹æ€§

- ğŸ° è€è™æœºé£æ ¼çš„éšæœºå†³ç­–åŠ¨ç”» + éŸ³æ•ˆ
- ğŸœ é¤å…å’Œèœå“ç®¡ç†ï¼ˆæ”¯æŒè‡ªåŠ¨è¡¥å…¨é¤å…åï¼‰
- ğŸ“Š æœ€è¿‘5å¤©ç”¨é¤å†å²è®°å½•
- ğŸ¯ åŠ æƒéšæœºç®—æ³•ï¼ˆæœ€è¿‘3æ¬¡åƒè¿‡çš„èœå“æ¦‚ç‡é™ä½50%ï¼‰
- ğŸ” ç”¨æˆ·ç™»å½•/æ³¨å†Œï¼ˆJWTè®¤è¯ï¼‰
- ğŸ“± å“åº”å¼è®¾è®¡ï¼Œæ”¯æŒç§»åŠ¨ç«¯

## æŠ€æœ¯æ ˆ

| å±‚çº§ | æŠ€æœ¯ |
|------|------|
| **Android** | Kotlin + Jetpack Compose + Hilt + Retrofit |
| **åç«¯** | Go 1.21+ + Gin + GORM + Zapæ—¥å¿— |
| **æ•°æ®åº“** | MySQL 8.0 |
| **éƒ¨ç½²** | Docker Compose |

## å¿«é€Ÿå¼€å§‹

### æ–¹å¼ä¸€ï¼šDocker Composeï¼ˆæ¨èï¼‰

```bash
# å¯åŠ¨ MySQL
docker-compose up -d
# è‹¥æ— dockerç¯å¢ƒ,ä½¿ç”¨ç°æœ‰ç¯å¢ƒ
éœ€è¦ä¿®æ”¹`backend/config/config.yaml`æ•°æ®åº“é…ç½®ã€‚
å¯åŠ¨æœåŠ¡ç«¯ä»£ç æ•°æ®åº“è´¦å·éœ€è¦DDLï¼ŒDMLæƒé™ã€‚
å¯åŠ¨åç«¯æ—¶ï¼Œåˆå§‹åŒ–æ•°æ®åº“ã€æ•°æ®è¡¨ã€æ•°æ®ã€‚



# å¯åŠ¨åç«¯é¡¹ç›®
chmod +x start.sh
# å¯åŠ¨æœåŠ¡ç«¯ï¼Œéœ€è¦Goè¯­è¨€ç¯å¢ƒ,å¦‚æœæ²¡æœ‰æ‰§è¡Œåˆå§‹åŒ–Goç¯å¢ƒè„šæœ¬
./start.sh backend

# å¯åŠ¨æˆåï¼Œåç«¯ä¼šè¾“å‡ºæ—¥å¿—
`Listening and serving HTTP {"address": ":8080", "local_ip": "10.100.7.109", "public_url": "http://10.100.7.109:8080", "health_check_url": "http://10.100.7.109:8080/health"}`
å®¢æˆ·ç«¯è®¾ç½®ä¸­ä¿®æ”¹urlä¸ºpublic_url

# åˆå§‹åŒ– Go è¯­è¨€ç¯å¢ƒï¼ˆé¦–æ¬¡è¿è¡Œéœ€è¦ï¼‰
chmod +x init-go.sh
./init-go.sh
```

### æ–¹å¼äºŒï¼šä¸€é”®å¯åŠ¨è„šæœ¬

ç¡®ä¿ MySQL æœåŠ¡å·²å¯åŠ¨ï¼Œç¼–è¾‘ `backend/config/config.yaml` é…ç½®æ•°æ®åº“è¿æ¥ï¼Œç„¶åï¼š

```bash
./start.sh start     # å¯åŠ¨åç«¯ï¼ˆé»˜è®¤ï¼‰
./start.sh backend   # å¯åŠ¨åç«¯ï¼ˆåŒ startï¼‰
./start.sh stop      # åœæ­¢åç«¯æœåŠ¡
./start.sh restart   # é‡å¯åç«¯æœåŠ¡
./start.sh help      # æ˜¾ç¤ºå¸®åŠ©
```

### æ–¹å¼ä¸‰ï¼šæ‰‹åŠ¨å¯åŠ¨

#### 1. åˆå§‹åŒ– Go ç¯å¢ƒï¼ˆé¦–æ¬¡è¿è¡Œï¼‰

```bash
# åœ¨é¡¹ç›®æ ¹ç›®å½•æ‰§è¡Œ
chmod +x init-go.sh
./init-go.sh
```

è¯¥è„šæœ¬ä¼šï¼š

- æ£€æŸ¥å¹¶å®‰è£… Goï¼ˆå¦‚æœæœªå®‰è£…ï¼‰
- é…ç½® Go ç¯å¢ƒå˜é‡å’Œä»£ç†
- ä¸‹è½½é¡¹ç›®ä¾èµ–
- éªŒè¯ç¼–è¯‘ç¯å¢ƒ

#### 2. å¯åŠ¨åç«¯

```bash
cd backend
go run cmd/server/main.go
```

æˆ–è€…å¦‚æœå·²è¿è¡Œè¿‡ `init-go.sh`ï¼Œå¯ä»¥ç›´æ¥ï¼š

```bash
cd backend
go run cmd/server/main.go
```

åç«¯ä¼šè‡ªåŠ¨åˆ›å»ºæ•°æ®åº“ã€è¡¨ç»“æ„å’Œé»˜è®¤æ•°æ®ã€‚

## ä½¿ç”¨è¯´æ˜

1. æ³¨å†Œè´¦å·å¹¶ç™»å½•
2. åœ¨å³ä¾§èœå•åˆ—è¡¨æ·»åŠ é¤å…å’Œèœå“
   - è¾“å…¥é¤å…åï¼ˆæ”¯æŒè‡ªåŠ¨è¡¥å…¨å·²æœ‰é¤å…ï¼‰
   - è¾“å…¥èœå“å
   - ç‚¹å‡»æ·»åŠ 
3. ç‚¹å‡»"å¼€å§‹å†³ç­–"æŒ‰é’®
4. è§‚çœ‹è€è™æœºåŠ¨ç”»ï¼Œäº«å—å†³ç­–è¿‡ç¨‹
5. æŸ¥çœ‹å†å²è®°å½•

## API æ¥å£

### è®¤è¯

| æ–¹æ³• | è·¯å¾„ | è¯´æ˜ |
|------|------|------|
| POST | `/api/auth/register` | ç”¨æˆ·æ³¨å†Œ |
| POST | `/api/auth/login` | ç”¨æˆ·ç™»å½• |

### èœå•ç®¡ç†

| æ–¹æ³• | è·¯å¾„ | è¯´æ˜ |
|------|------|------|
| GET | `/api/menus` | è·å–èœå•åˆ—è¡¨ |
| POST | `/api/menus` | æ·»åŠ èœå“ï¼ˆåŒæ—¶å¤„ç†é¤å…ï¼‰ |
| DELETE | `/api/menus/:id` | åˆ é™¤èœå“ |
| GET | `/api/restaurants` | è·å–é¤å…åˆ—è¡¨ï¼ˆç”¨äºä¸‹æ‹‰é€‰æ‹©ï¼‰ |

### å†³ç­–

| æ–¹æ³• | è·¯å¾„ | è¯´æ˜ |
|------|------|------|
| POST | `/api/decide` | æ‰§è¡Œéšæœºå†³ç­– |
| GET | `/api/history` | è·å–æœ€è¿‘5å¤©çš„å†å²è®°å½• |

## åŠ æƒéšæœºç®—æ³•

ä¸ºäº†é¿å…ç”¨æˆ·è¿ç»­å¤šå¤©åƒåŒæ ·çš„é£Ÿç‰©ï¼Œç³»ç»Ÿå®ç°äº†åŠ æƒéšæœºç®—æ³•ï¼š

```
æ­£å¸¸èœå“æƒé‡: 1.0
æœ€è¿‘3æ¬¡åƒè¿‡çš„èœå“æƒé‡: 0.5 (æ¦‚ç‡é™ä½50%)
```

## æ•°æ®åº“è®¾è®¡

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   users     â”‚     â”‚ restaurants â”‚     â”‚ decision_records â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤     â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤     â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ id          â”‚     â”‚ id          â”‚     â”‚ id               â”‚
â”‚ username    â”‚     â”‚ name        â”‚     â”‚ user_id          â”‚
â”‚ password    â”‚     â”‚ created_at  â”‚     â”‚ menu_id          â”‚
â”‚ created_at  â”‚     â”‚ updated_at  â”‚     â”‚ decided_at       â”‚
â”‚ updated_at  â”‚     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜            â”‚
                           â”‚ 1:N
                           â–¼
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚   menus     â”‚
                    â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
                    â”‚ id          â”‚
                    â”‚ restaurant_idâ”‚
                    â”‚ dish_name   â”‚
                    â”‚ created_at  â”‚
                    â”‚ updated_at  â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## Android å®¢æˆ·ç«¯

è¯¦ç»†è¯´æ˜è¯·æŸ¥çœ‹ [android/README.md](android/README.md)

### å¿«é€Ÿå¼€å§‹

1. ä½¿ç”¨ Android Studio æ‰“å¼€ `android` ç›®å½•
2. åœ¨è®¾ç½®é¡µé…ç½®æœåŠ¡å™¨åœ°å€ï¼š
   - æ¨¡æ‹Ÿå™¨: `http://10.0.2.2:8080`
   - çœŸæœº: `http://<ç”µè„‘IP>:8080`
3. æ„å»ºå¹¶è¿è¡Œ

```bash
cd android
./gradlew assembleDebug
```

## é¡¹ç›®ç»“æ„

```
.
â”œâ”€â”€ start.sh                 # ä¸€é”®å¯åŠ¨è„šæœ¬
â”œâ”€â”€ docker-compose.yml       # Docker Compose é…ç½®
â”œâ”€â”€ android/                 # Android å®¢æˆ·ç«¯ (Kotlin + Jetpack Compose)
â”‚   â”œâ”€â”€ app/src/main/java/   # Kotlin æºç 
â”‚   â””â”€â”€ README.md            # Android æ–‡æ¡£
â”œâ”€â”€ backend/                 # Go åç«¯
â”‚   â”œâ”€â”€ cmd/server/         # å…¥å£æ–‡ä»¶
â”‚   â”œâ”€â”€ config/             # Viper é…ç½®
â”‚   â”œâ”€â”€ internal/
â”‚   â”‚   â”œâ”€â”€ handler/        # HTTP å¤„ç†å™¨
â”‚   â”‚   â”œâ”€â”€ service/        # ä¸šåŠ¡é€»è¾‘ï¼ˆå«åŠ æƒéšæœºç®—æ³•ï¼‰
â”‚   â”‚   â”œâ”€â”€ repository/     # æ•°æ®è®¿é—®ï¼ˆå«æ•°æ®åº“åˆå§‹åŒ–ï¼‰
â”‚   â”‚   â””â”€â”€ model/          # æ•°æ®æ¨¡å‹
â”‚   â””â”€â”€ pkg/
â”‚       â”œâ”€â”€ middleware/     # JWTè®¤è¯ã€CORSã€æ—¥å¿—ä¸­é—´ä»¶
â”‚       â””â”€â”€ logger/         # Zap æ—¥å¿—å°è£…
â”œâ”€â”€ sql/
â”‚   â””â”€â”€ init.sql            # æ•°æ®åº“åˆå§‹åŒ–è„šæœ¬ï¼ˆå¤‡ç”¨ï¼‰
â””â”€â”€ README.md
```

## é…ç½®è¯´æ˜

### åç«¯é…ç½® (`backend/config/config.yaml`)

```yaml
server:
  port: "8080"
  mode: "debug"

database:
  host: "127.0.0.1"
  port: "3306"
  user: "root"
  password: "root123456"
  dbname: "what_to_eat"

jwt:
  secret: "your-secret-key"
  expire_time: 24

log:
  level: "info"
  format: "console"
  output_path: "stdout"
```

æ”¯æŒç¯å¢ƒå˜é‡è¦†ç›–ï¼ˆå‰ç¼€ `APP_`ï¼‰ï¼š

- `APP_DATABASE_HOST`
- `APP_DATABASE_PASSWORD`
- `APP_JWT_SECRET`

### Docker Compose

```bash
# å¯åŠ¨ MySQL
docker-compose up -d

# æŸ¥çœ‹æ—¥å¿—
docker-compose logs -f

# åœæ­¢
docker-compose down
```

MySQL é…ç½®ï¼š

- ç«¯å£: 3306
- ç”¨æˆ·: root / root123456
- æ•°æ®åº“: what_to_eat

## è¿è¡Œæµ‹è¯•

```bash
cd backend
go test ./... -v
```

## License

MIT
